<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sign In</title>
  <style>
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto; background:#0f172a; color:#e5e7eb; }
    .wrap { min-height: 100vh; display:grid; place-items:center; padding:2rem; }
    .card { width:100%; max-width:480px; background:rgba(255,255,255,.04); border:1px solid rgba(148,163,184,.2);
            border-radius:16px; padding:1.25rem; box-shadow:0 10px 40px rgba(0,0,0,.35); }
    h1 { margin:0 0 .5rem; }
    label { display:block; font-weight:600; margin:.75rem 0 .35rem; }
    input { width:100%; padding:.9rem .95rem; border-radius:12px; border:1px solid #334155; background:#1f2937; color:#e5e7eb; }
    input:focus { outline:none; border-color:#60a5fa; box-shadow:0 0 0 3px rgba(96,165,250,.25); }
    button { margin-top:1rem; border:0; background:#60a5fa; color:#0b1220; padding:.85rem 1rem; border-radius:12px; font-weight:700; cursor:pointer; }
    .muted{ color:#94a3b8; } .err{ color:#fca5a5; margin-top:.5rem; }
  </style>
</head>
<body>
  <main class="wrap">
    <section class="card">
      <h1>Sign in</h1>
      <p class="muted">Use the phone and password you signed up with.</p>
      <form id="signin" novalidate>
        <label for="phone">Phone</label>
        <input id="phone" type="tel" placeholder="+447123456789" required />
        <label for="password">Password</label>
        <input id="password" type="password" required />
        <button type="submit" id="btn">Sign in</button>
        <p id="msg" class="err"></p>
      </form>
      <p class="muted" style="margin-top:1rem;">No account? <a href="/signup.html">Create one</a></p>
    </section>
  </main>
  <script>
    const form = document.getElementById('signin');
    const msg = document.getElementById('msg');
    const btn = document.getElementById('btn');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const phone = document.getElementById('phone').value.trim();
      const password = document.getElementById('password').value;
      if (!phone || !password) { msg.textContent = 'Phone and password are required.'; return; }
      btn.disabled = true; msg.textContent = 'Signing inâ€¦';
      try {
        const res = await fetch('/api/signin', {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ phone, password })
        });
        const data = await res.json().catch(()=>({}));
        if (!res.ok) { msg.textContent = data?.error || 'Sign in failed'; btn.disabled = false; return; }
        window.location.assign('/welcome.html');
      } catch {
        msg.textContent = 'Network error. Is the server running?';
        btn.disabled = false;
      }
    });
  </script>
</body>
</html>
